[buildout]
extends = base.cfg
parts = ${buildout:python31-parts}
python31-parts =
    virtualenv3
    python-3.1-build
    python-3.1-virtualenv
    python-3.1
    python-3.1-test

[python-3.1-build:default]
recipe = monkeycmmi
dependencies = ${dependencies:dummy-dependencies}
executable = ${opt:location}/bin/python3.1
url = http://www.python.org/ftp/python/3.1.2/Python-3.1.2.tar.bz2
extra_options =
    --disable-tk
    --prefix=${opt:location}

[python-3.1-virtualenv]
recipe = collective.recipe.template
input = ${buildout:python-buildout-root}/virtualenv3.in
output = ${buildout:bin-directory}/virtualenv-3.1
virtualenv = ${virtualenv3:location}/virtualenv3.py
executable = ${python-3.1-build:executable}

[python-3.1]
recipe = plone.recipe.command
location = ${buildout:directory}/python-3.1
executable = ${python-3.1-build:executable}
command =
    ${buildout:directory}/bin/virtualenv-3.1 ${buildout:directory}/python-3.1
update-command = ${python-3.1:command}
stop-on-error = yes

[python-3.1-test]
recipe = z3c.recipe.runscript
install-script = ${buildout:python-buildout-root}/test-python.py:test
update-script = ${:install-script}
python = ${python-3.1:location}/bin/python
